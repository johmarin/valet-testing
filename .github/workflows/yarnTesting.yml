name: YarnTesting
on:
  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:
env:
  SYSTEM.DEBUG: 'false'
jobs:
  serverjob:
    runs-on: ubuntu-latest
    steps:
    - name: checkout
      uses: actions/checkout@v2
    - name: Yarn
      run: |-
        npm set //pkgs.dev.azure.com/${{ env.FEED_ORGANIZATION_NAME }}/${{ env.FEED_PROJECT_ID }}/_packaging/${{ env.FEED_PACKAGE_NAME }}/npm/registry/:username=user
        npm set //pkgs.dev.azure.com/${{ env.FEED_ORGANIZATION_NAME }}/${{ env.FEED_PROJECT_ID }}/_packaging/${{ env.FEED_PACKAGE_NAME }}/npm/registry/:_password=${{ env.NPM_PASSWORD }}
        npm set //pkgs.dev.azure.com/${{ env.FEED_ORGANIZATION_NAME }}/${{ env.FEED_PROJECT_ID }}/_packaging/${{ env.FEED_PACKAGE_NAME }}/npm/registry/:email=email
        npm set //pkgs.dev.azure.com/${{ env.FEED_ORGANIZATION_NAME }}/${{ env.FEED_PROJECT_ID }}/_packaging/${{ env.FEED_PACKAGE_NAME }}/npm/:username=user
        npm set //pkgs.dev.azure.com/${{ env.FEED_ORGANIZATION_NAME }}/${{ env.FEED_PROJECT_ID }}/_packaging/${{ env.FEED_PACKAGE_NAME }}/npm/:_password=${{ env.NPM_PASSWORD }}
        npm set //pkgs.dev.azure.com/${{ env.FEED_ORGANIZATION_NAME }}/${{ env.FEED_PROJECT_ID }}/_packaging/${{ env.FEED_PACKAGE_NAME }}/npm/:email=email
        yarn --cwd yarnProjectDirectory --verbose --production
      env:
        FEED_ORGANIZATION_NAME: johmarin
        FEED_PROJECT_ID: b8123011-3f85-49c9-af12-4deb3053c510
        FEED_PACKAGE_NAME: NpmTestFeed1
        NPM_PASSWORD: "${{ secrets.NPMTESTFEED1_PAT }}"
